# –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞ —Ä–æ–±–æ—Ç–∞ ‚Ññ1: MLOps Environment & Experiment Tracking

–¶–µ–π –ø—Ä–æ–µ–∫—Ç –ø—Ä–∏—Å–≤—è—á–µ–Ω–∏–π –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—é –ø—Ä–æ—Ñ–µ—Å—ñ–π–Ω–æ–≥–æ —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞ –¥–ª—è Data Science, —Å—Ç—Ä—É–∫—Ç—É—Ä—É–≤–∞–Ω–Ω—é –ø—Ä–æ–µ–∫—Ç—É —Ç–∞ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü—ñ—ó –≤—ñ–¥—Å—Ç–µ–∂–µ–Ω–Ω—è –µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ñ–≤ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é **MLflow**.

## üìå –ú–µ—Ç–∞
–°—Ç–≤–æ—Ä–µ–Ω–Ω—è –ø–∞–π–ø–ª–∞–π–Ω—É –Ω–∞–≤—á–∞–Ω–Ω—è –º–æ–¥–µ–ª—ñ –¥–ª—è –ø—Ä–æ–≥–Ω–æ–∑—É–≤–∞–Ω–Ω—è —ñ–Ω—Å—É–ª—å—Ç—É (Stroke Prediction) –∑ —É—Ä–∞—Ö—É–≤–∞–Ω–Ω—è–º —Å–∏–ª—å–Ω–æ–≥–æ –¥–∏—Å–±–∞–ª–∞–Ω—Å—É –∫–ª–∞—Å—ñ–≤, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ –Ω–∞–π–∫—Ä–∞—â—ñ –ø—Ä–∞–∫—Ç–∏–∫–∏ MLOps.

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç—É
–ü—Ä–æ–µ–∫—Ç –æ—Ä–≥–∞–Ω—ñ–∑–æ–≤–∞–Ω–æ –∑–≥—ñ–¥–Ω–æ –∑—ñ —Å–ø—Ä–æ—â–µ–Ω–∏–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–æ–º Cookiecutter Data Science:

```
mlops_lab_1/
‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îî‚îÄ‚îÄ raw/            # –°–∏—Ä—ñ –¥–∞–Ω—ñ (healthcare-dataset-stroke-data.csv)
‚îú‚îÄ‚îÄ notebooks/
‚îÇ   ‚îî‚îÄ‚îÄ 01_eda.ipynb    # Jupyter Notebook –¥–ª—è —Ä–æ–∑–≤—ñ–¥—É–≤–∞–ª—å–Ω–æ–≥–æ –∞–Ω–∞–ª—ñ–∑—É –¥–∞–Ω–∏—Ö (EDA)
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îî‚îÄ‚îÄ train.py        # –û—Å–Ω–æ–≤–Ω–∏–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è –Ω–∞–≤—á–∞–Ω–Ω—è —Ç–∞ –ª–æ–≥—É–≤–∞–Ω–Ω—è –µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ñ–≤
‚îú‚îÄ‚îÄ mlruns/             # –õ–æ–∫–∞–ª—å–Ω–µ —Å—Ö–æ–≤–∏—â–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ñ–≤ MLflow
‚îú‚îÄ‚îÄ models/             # –î–∏—Ä–µ–∫—Ç–æ—Ä—ñ—è –¥–ª—è –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –º–æ–¥–µ–ª–µ–π
‚îú‚îÄ‚îÄ venv/               # –í—ñ—Ä—Ç—É–∞–ª—å–Ω–µ —Å–µ—Ä–µ–¥–æ–≤–∏—â–µ
‚îú‚îÄ‚îÄ requirements.txt    # –ó–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ –ø—Ä–æ–µ–∫—Ç—É
‚îî‚îÄ‚îÄ README.md           # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è
```

## üöÄ –Ø–∫ –∑–∞–ø—É—Å—Ç–∏—Ç–∏

### 1. –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞
–°—Ç–≤–æ—Ä—ñ—Ç—å –≤—ñ—Ä—Ç—É–∞–ª—å–Ω–µ —Å–µ—Ä–µ–¥–æ–≤–∏—â–µ —Ç–∞ –≤—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ:

```bash
# –°—Ç–≤–æ—Ä–µ–Ω–Ω—è venv
python3 -m venv venv

# –ê–∫—Ç–∏–≤–∞—Ü—ñ—è (Linux/MacOS)
source venv/bin/activate

# –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –±—ñ–±–ª—ñ–æ—Ç–µ–∫
pip install -r requirements.txt
```

### 2. –ó–∞–ø—É—Å–∫ EDA
–î–ª—è –ø–µ—Ä–µ–≥–ª—è–¥—É –∞–Ω–∞–ª—ñ–∑—É –¥–∞–Ω–∏—Ö –∑–∞–ø—É—Å—Ç—ñ—Ç—å Jupyter Notebook:

```bash
jupyter notebook notebooks/01_eda.ipynb
```

### 3. –¢—Ä–µ–Ω—É–≤–∞–Ω–Ω—è –º–æ–¥–µ–ª—ñ
–ó–∞–ø—É—Å—Ç—ñ—Ç—å —Å–∫—Ä–∏–ø—Ç `src/train.py`. –í—ñ–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –≤–∏–∫–æ–Ω–∞—î —Å–µ—Ä—ñ—é –µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ñ–≤ –∑ —Ä—ñ–∑–Ω–∏–º–∏ –≥—ñ–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ (–≥–ª–∏–±–∏–Ω–∞ –¥–µ—Ä–µ–≤–∞) —Ç–∞ –∑–∞–ª–æ–≥—É—î —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏ –≤ MLflow.

```bash
python src/train.py --n_estimators 200 --learning_rate 0.05
```

–°–∫—Ä–∏–ø—Ç –≤–∏–∫–æ–Ω—É—î –Ω–∞—Å—Ç—É–ø–Ω—ñ –∫—Ä–æ–∫–∏:
1.  –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ç–∞ –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å–∏–Ω–≥ –¥–∞–Ω–∏—Ö.
2.  –†–æ–∑–±–∏—Ç—Ç—è –Ω–∞ train/test (—Å—Ç—Ä–∞—Ç–∏—Ñ—ñ–∫–æ–≤–∞–Ω–µ).
3.  –ù–∞–≤—á–∞–Ω–Ω—è **XGBoost** –∑ –±–∞–ª–∞–Ω—Å—É–≤–∞–Ω–Ω—è–º –∫–ª–∞—Å—ñ–≤ (`scale_pos_weight`).
4.  –ü—ñ–¥–±—ñ—Ä –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ –ø–æ—Ä–æ–≥—É –∫–ª–∞—Å–∏—Ñ—ñ–∫–∞—Ü—ñ—ó (Threshold Tuning) –¥–ª—è –º–∞–∫—Å–∏–º—ñ–∑–∞—Ü—ñ—ó F1-score.
5.  –õ–æ–≥—É–≤–∞–Ω–Ω—è –º–µ—Ç—Ä–∏–∫ (Accuracy, F1, Precision, Recall, ROC-AUC) —Ç–∞ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ñ–≤ (Confusion Matrix, Feature Importance).

### 4. –ü–µ—Ä–µ–≥–ª—è–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤ (MLflow UI)
–©–æ–± –ø–æ—Ä—ñ–≤–Ω—è—Ç–∏ –µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏ –≤—ñ–∑—É–∞–ª—å–Ω–æ:

```bash
mlflow ui
```
–í—ñ–¥–∫—Ä–∏–π—Ç–µ —É –±—Ä–∞—É–∑–µ—Ä—ñ: [http://127.0.0.1:5000](http://127.0.0.1:5000)

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç–∏ —Ç–∞ –ê–Ω–∞–ª—ñ–∑
–í —Ö–æ–¥—ñ –µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ñ–≤ –±—É–ª–æ –ø—Ä–æ—Ç–µ—Å—Ç–æ–≤–∞–Ω–æ XGBoost –∑ —Ä—ñ–∑–Ω–æ—é –≥–ª–∏–±–∏–Ω–æ—é –¥–µ—Ä–µ–≤ (`max_depth`: 2, 3, 4, 5, 6, 10, 20).

**–ö–ª—é—á–æ–≤—ñ —Å–ø–æ—Å—Ç–µ—Ä–µ–∂–µ–Ω–Ω—è (–Ω–∞ –æ—Å–Ω–æ–≤—ñ MLflow):**

1.  **–î–∏—Å–±–∞–ª–∞–Ω—Å –ö–ª–∞—Å—ñ–≤**:
    *   –î–∞–Ω—ñ –º–∞—é—Ç—å —Å–∏–ª—å–Ω–∏–π –¥–∏—Å–±–∞–ª–∞–Ω—Å (~1:19).
    *   –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è `scale_pos_weight` –¥–æ–∑–≤–æ–ª–∏–ª–æ –º–æ–¥–µ–ª—ñ –∑–≤–µ—Ä—Ç–∞—Ç–∏ —É–≤–∞–≥—É –Ω–∞ –º—ñ–Ω–æ—Ä–Ω–∏–π –∫–ª–∞—Å, –∞–ª–µ –ø—Ä–∏–∑–≤–µ–ª–æ –¥–æ –∑–Ω–∞—á–Ω–æ—ó –∫—ñ–ª—å–∫–æ—Å—Ç—ñ False Positives (–Ω–∏–∑—å–∫–∏–π Precision).

2.  **–ó–∞–ª–µ–∂–Ω—ñ—Å—Ç—å –≤—ñ–¥ –ì–ª–∏–±–∏–Ω–∏ –î–µ—Ä–µ–≤–∞ (Overfitting)**:
    *   –ó—ñ –∑–±—ñ–ª—å—à–µ–Ω–Ω—è–º –≥–ª–∏–±–∏–Ω–∏ –¥–µ—Ä–µ–≤–∞ (`max_depth > 4`) —Å–ø–æ—Å—Ç–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è **—Ä—ñ–∑–∫–µ –ø–µ—Ä–µ–Ω–∞–≤—á–∞–Ω–Ω—è**.
    *   –ú–µ—Ç—Ä–∏–∫–∏ –Ω–∞ —Ç—Ä–µ–Ω—É–≤–∞–ª—å–Ω—ñ–π –≤–∏–±—ñ—Ä—Ü—ñ (`train_f1`, `train_recall`) –¥–æ—Å—è–≥–∞—é—Ç—å **1.0**, —Ç–æ–¥—ñ —è–∫ –Ω–∞ —Ç–µ—Å—Ç–æ–≤—ñ–π –ø–∞–¥–∞—é—Ç—å (–¥–∏–≤. –≥—Ä–∞—Ñ—ñ–∫ `train_f1` vs `test_f1`).
    *   –ì–ª–∏–±–æ–∫—ñ –¥–µ—Ä–µ–≤–∞ "–∑–∞–ø–∞–º'—è—Ç–æ–≤—É—é—Ç—å" —à—É–º, –≤—Ç—Ä–∞—á–∞—é—á–∏ –∑–¥–∞—Ç–Ω—ñ—Å—Ç—å —É–∑–∞–≥–∞–ª—å–Ω—é–≤–∞—Ç–∏.

3.  **–ù–∞–π–∫—Ä–∞—â–∞ –ú–æ–¥–µ–ª—å (Depth=2)**:
    *   –ù–∞–π–∫—Ä–∞—â—ñ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏ –ø–æ–∫–∞–∑–∞–ª–∞ –º–æ–¥–µ–ª—å –∑ `max_depth=2`.
    *   **Test F1-score:** ~0.33 (–Ω–∞–π–≤–∏—â–∏–π —Å–µ—Ä–µ–¥ —É—Å—ñ—Ö –µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ñ–≤).
    *   **Test Recall:** ~0.56 (–º–æ–¥–µ–ª—å –≤–∏—è–≤–ª—è—î –±—ñ–ª—å—à–µ –ø–æ–ª–æ–≤–∏–Ω–∏ –ø–∞—Ü—ñ—î–Ω—Ç—ñ–≤ –∑ —Ä–∏–∑–∏–∫–æ–º —ñ–Ω—Å—É–ª—å—Ç—É).
    *   **Test Precision:** ~0.24 (–∫–æ–∂–µ–Ω —á–µ—Ç–≤–µ—Ä—Ç–∏–π –ø—Ä–æ–≥–Ω–æ–∑ "—ñ–Ω—Å—É–ª—å—Ç" —î –ø—Ä–∞–≤–∏–ª—å–Ω–∏–º).
    *   **Test ROC-AUC:** ~0.84 (–≤–∫–∞–∑—É—î –Ω–∞ —Ö–æ—Ä–æ—à—É —Ä–æ–∑–¥—ñ–ª—å–Ω—É –∑–¥–∞—Ç–Ω—ñ—Å—Ç—å –º–æ–¥–µ–ª—ñ).

4.  **Optimal Threshold**:
    *   –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π –ø—ñ–¥–±—ñ—Ä –ø–æ—Ä–æ–≥—É –∫–ª–∞—Å–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –ø–æ–∫–∞–∑–∞–≤, —â–æ –æ–ø—Ç–∏–º–∞–ª—å–Ω–µ –∑–Ω–∞—á–µ–Ω–Ω—è –∑–Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤ –¥—ñ–∞–ø–∞–∑–æ–Ω—ñ **0.72‚Äì0.83** (–∑–Ω–∞—á–Ω–æ –≤–∏—â–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ 0.5), —â–æ –¥–æ–∑–≤–æ–ª–∏–ª–æ –º–∞–∫—Å–∏–º—ñ–∑—É–≤–∞—Ç–∏ F1-score.

### üñºÔ∏è –í—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—è –†–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤ (MLflow)

> **–ü—Ä–∏–º—ñ—Ç–∫–∞**: –ù–∏–∂—á–µ –Ω–∞–≤–µ–¥–µ–Ω—ñ —Å–∫—Ä—ñ–Ω—à–æ—Ç–∏ –∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ –µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ñ–≤.

**–ü–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è –º–µ—Ç—Ä–∏–∫ (Parallel Coordinates & Bar Charts):**
![MLflow Metrics Comparison](assets/uploaded_media_0_1771088168944.png)
*–ü–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è –æ—Å–Ω–æ–≤–Ω–∏—Ö –º–µ—Ç—Ä–∏–∫ (Recall, F1, Accuracy) –¥–ª—è —Ä—ñ–∑–Ω–∏—Ö –≥–ª–∏–±–∏–Ω –¥–µ—Ä–µ–≤.*

![Training vs Test Performance](assets/uploaded_media_1_1771088168944.png)
*–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü—ñ—è –ø–µ—Ä–µ–Ω–∞–≤—á–∞–Ω–Ω—è (Overfitting): Train F1 = 1.0 vs Test F1 << 0.5 –¥–ª—è –≥–ª–∏–±–æ–∫–∏—Ö –¥–µ—Ä–µ–≤.*

**–î–µ—Ç–∞–ª—å–Ω–∏–π –∞–Ω–∞–ª—ñ–∑ –µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ñ–≤:**
![Experiment Details Table](assets/uploaded_media_2_1771088168944.png)
*–ó–≤–µ–¥–µ–Ω–∞ —Ç–∞–±–ª–∏—Ü—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤ –∑ MLflow.*

![Parallel Coordinates Analysis](assets/uploaded_media_3_1771088168944.png)
*–ê–Ω–∞–ª—ñ–∑ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ –º–µ—Ç—Ä–∏–∫ –≤—ñ–¥ –≥—ñ–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ (max_depth).*

**–í–∞–∂–ª–∏–≤—ñ—Å—Ç—å –æ–∑–Ω–∞–∫ (Feature Importance):**
![Feature Importance](assets/feature_importance_best.png)
*–¢–æ–ø-10 –Ω–∞–π–≤–∞–∂–ª–∏–≤—ñ—à–∏—Ö –æ–∑–Ω–∞–∫ –¥–ª—è –º–æ–¥–µ–ª—ñ XGBoost (Depth=2). –ù–∞–π–±—ñ–ª—å—à–∏–π –≤–ø–ª–∏–≤ –º–∞—î **–í—ñ–∫ (age)**, —â–æ —É–∑–≥–æ–¥–∂—É—î—Ç—å—Å—è –∑ –º–µ–¥–∏—á–Ω–∏–º–∏ –¥–∞–Ω–∏–º–∏, –∞ —Ç–∞–∫–æ–∂ —Ä—ñ–≤–µ–Ω—å –≥–ª—é–∫–æ–∑–∏ —Ç–∞ —ñ–Ω–¥–µ–∫—Å –º–∞—Å–∏ —Ç—ñ–ª–∞.*

## üõ† –¢–µ—Ö–Ω–æ–ª–æ–≥—ñ—ó
*   **Python 3.13**
*   **XGBoost**: –ì—Ä–∞–¥—ñ—î–Ω—Ç–Ω–∏–π –±—É—Å—Ç–∏–Ω–≥ (–æ—Å–Ω–æ–≤–Ω–∏–π –∞–ª–≥–æ—Ä–∏—Ç–º).
*   **Scikit-learn**: Pipeline, ColumnTransformer, Metrics.
*   **Imbalanced-learn** / **Weights**: –û–±—Ä–æ–±–∫–∞ –¥–∏—Å–±–∞–ª–∞–Ω—Å—É –∫–ª–∞—Å—ñ–≤.
*   **MLflow**: –õ–æ–≥—É–≤–∞–Ω–Ω—è –º–µ—Ç—Ä–∏–∫, –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ —Ç–∞ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ñ–≤.
*   **Pandas, NumPy, Matplotlib, Seaborn**: –ê–Ω–∞–ª—ñ–∑ –¥–∞–Ω–∏—Ö —Ç–∞ –≤—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—è.

